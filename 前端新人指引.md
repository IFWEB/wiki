# 入职指引
## 沟通工具
### QQ群
技术一部：322983516 研发中心：275053163
### 微信群（找同事拉入）
 我们前端 农金圈工作群
 ## 安装软件
 钉钉 foxmail evernote sublime chrome photoshop fiddler node python2.7.10 svn
 需要在钉钉上申请固态硬盘和内存条安装在电脑上。
 ## SVN
 ### 地址
 h5、pc、console前端代码：https://nfd-server02/svn/front/
 活动前端：https://nfd-server02/svn/front-activity
 ### 账户（找配置管理员开通）
 账户：个人姓名拼音
 密码：nfd12345678
 ## 开发环境及工具
 ### [编码规范](http://imweb.github.io/CodeGuide/)
 ### [构建工具fis3主页](http://fis.baidu.com/fis3/docs/beginning/intro.html)
 ### [FIS demo](https://github.com/beyond-cheng/fis-demo)
 ### [sass 预编译](http://sass-lang.com/documentation/file.SASS_REFERENCE.html)
 ### [cnpm](https://npm.taobao.org/)
 ### [图片压缩（普通图片最好不要超过100KB,Banner不要超过120KB）](https://tinypng.com/)
 ### [markdown语法](http://www.appinn.com/markdown/)

 ### TAPD
 找李冬冬开通
 ### 内部服务器.5.7.20等
 账户名：root 密码:nongfadai
 ### 前端独立打包
 [前端独立打包](http://10.1.60.68:8000/)
 自己注册、登录就可以
 ### 内部数据库
 密码：test123
 

### 小白运行前端代码——前端工具安装以及运行
#### 1.安装nodejs
出于对fis3的支持，使用的版本是4.4.3的版本。目录:[https://nodejs.org/download/release/v4.4.3/](https://nodejs.org/download/release/v4.4.3/)  根据电脑操作系统选择安装包。安装node会内置npm，使用npm安装其他的工具包。推荐使用淘宝的镜像:cnpm。cnpm安装命令:  
```
> npm install -g cnpm --registry=https://registry.npm.taobao.org
```
![cnpm安装效果](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/1.png)
安装成功后就可以使用cnpm来替代npm安装各种工具包，速度会快很多。

#### 2，安装python，并加入到全局环境变量
[https://www.python.org/downloads/release/python-2710/](https://www.python.org/downloads/release/python-2710/)

#### 3.安装fis3和相关插件（工具包）
fis3的Node 版本要求 0.8.x，0.10.x, 0.12.x，4.x，6.x，不在此列表中的版本不予支持。安装命令：
```
> cnpm install fis3 fis3-deploy-nfd-deliver fis3-hook-commonjs fis-parser-imweb-tplv2 fis3-postpackager-loader fis-prepackager-csswrapper fis3-command-imweb fis3-deploy-nfd-deliver-dist-m fis3-prepackager-component-preview fis-parser-node-sass-nfd fis3-hook-iconfont-nfd fis-parser-node-sass-nfd -g
```
在fis打包或运行脚本中如果遇到提示缺少插件,如
```
[ERROR] unable to load plugin [fis3-hook-iconfont-nfd] or [fis-hook-iconfont-nfd]
```
使用cnpm命令全局安装即可
```
> cnpm install fis3-hook-iconfont-nfd -g
```

#### 4.fis3打包 
前端代码需要fis3打包才能使用。拉取前端svn代码，如https://nfd-server02/svn/front/trunk ，拉取到D:/workspace_temp目录。进入要打包的项目（目前前端有pc/h5/activity/console等项目），以pc为例。  
![目录结构](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/2.png)
进入项目的D:/workspace_temp/pc目录，打开cmd命令，输入：
```
D:/workspace_temp/pc> fis3 imweb dev -wc
```
**注：如果提示没有安装插件，则全局安装相应插件，安装命令：npm install 插件名称 -g**

#### 5.运行前端服务 
前端页面要在浏览器中运行起来，需要有一个本地服务提供服务，实际就是运行master.js。定位到项目根目录：D:/workspace_temp。打开命令行,安装服务需要的依赖包，输入:
```
D:/workspace_temp> cnpm install
```
安装成功以后启动服务，以pc为例
```
D:/workspace_temp> node master pc -p 5005
```
**注：pc 表示启动pc -p配置服务端口号**   
在浏览器访问localhost:5005就能看到pc首页了。

#### 6.切换后台提供接口的服务器 
前端服务默认转发请求到现网服务器获取数据。可以点击页面左下角的小绿点，查看并切换将请求转发到指定的服务器。如下图，选择host为.5，然后点击按钮刷新页面即可。
![master控制台](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/3.png)

#### 7.配置后台服务器 
在当前的host不满足要求式。还可以到前端服务配置文件中配置host,配置文件路径D:\workspace_temp\node-dev\config\index.js  
以修改.23为.20为例  
![配置文件1](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/4.png)  
修改后  
![配置文件3](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/5.png)   
重启前端服务  
```
D:/workspace_temp> node master pc -p 5005
```
重复第6步，切换到20服务器。  


### 前端独立打包工具使用
访问路径：[http://10.1.60.68:8000/](http://10.1.60.68:8000/)   
一个新的分支打包的步骤为：新建-->构建  

#### 1.新建打包 
以分支[https://nfd-server02/svn/front/branches/lcjh20170605/](https://nfd-server02/svn/front/branches/lcjh20170605/) 为例，填写新建打包项  
![新建打包](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/6.png)  
点击保存。第一个条目就是新建的打包项目。  
![打包项目列表](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/7.png)   
**注：没有使用的打包及时删除**

#### 2.构建 
点击“构建”按钮构建项目  
![构建](https://raw.githubusercontent.com/IFWEB/wiki/master/img/newer/8.png)  
等待构建完成即可。

#### 3.服务重启教程 
有时打包会出错，导致服务器挂掉。此时需要重启。  

mongodb数据库重启：   
1.用ssh连接上10.1.60.68 账号／密码： root／nongfadai   
2.进入到/home/ifweb/mongodb-linux-x86_64-3.4.2/bin/ 目录下   
3.杀掉进程：killall -9 mongod   
4. 输入命令 rm -rf /data/db/mongod.lock   
5.输入命令启动命令： nohup ./mongod &   
6.重启下node-deploy   

旧node-deploy 重启：  端口8000 
1.用ssh连接上10.1.60.68 账号／密码： root／nongfadai   
2.进入到/home/ifweb/node-deploy-new/node-deploy 目录下   
3.杀掉进程：killall -9 node   
4.输入命令启动命令： nohup node index.js &  
     

新node-deploy 重启： 端口3000 
 1. 用ssh连接上10.1.60.68 账号／密码： root／nongfadai
 2. 进入到/home/ifweb/new-node-deploy/node-deploy 目录下
 3. 停止forever进程 forever stop ./lib-dist/app.js
 4. 输入命令启动命令：NODE_ENV=prod forever start ./lib-dist/app.js
### 新console前端代码运行
1. 下载新console代码，如https://nfd-server02/svn/front/branches/console-lcjh0629/console 到工程D:/code/
2. 命令行定位到对应工程，如console，cmd运行: cd code/console
3. 下载依赖包: cmd 运行cnpm install
4. 执行打包命令: cmd 运行npm run start
5. 在浏览器访问localhost:5000就能看到新console首页了
6. 如需配置访问的服务器ip,定位到./build/node-dev/config/index.js中的ip配置,同上前端代码运行7

 ## [理财农场知识图谱](http://naotu.baidu.com/file/65d1c930ac90d3fae911147bdd3d7df2?token=92df4c029fbb6549)
